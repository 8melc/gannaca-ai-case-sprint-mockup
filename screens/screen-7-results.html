<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workshop-Ergebnis | gannaca AI Case Sprint</title>
  
  <!-- Styles -->
  <link rel="stylesheet" href="../styles/variables.css">
  <link rel="stylesheet" href="../styles/main.css">
  <link rel="stylesheet" href="../styles/components.css">
  
  <!-- Google Fonts (Inter) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Storage Script -->
  <script src="../js/storage.js"></script>
  
  <!-- Toast Notification System -->
  <script src="../js/toast.js"></script>
  
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  
  <style>
    .cases-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: var(--space-6);
      margin: var(--space-10) 0;
    }
    
    .case-card {
      background: var(--white);
      border-radius: var(--border-radius-lg);
      padding: var(--space-6);
      transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s, background-color 0.2s;
      border: 1px solid var(--border-gray);
      cursor: pointer; /* KLICKBAR! */
      position: relative;
    }
    
    .case-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      border-color: var(--navy);
      background: #F5F7FF; /* Leichtes Highlight */
    }
    
    .case-edit-hint {
      position: absolute;
      top: 12px;
      right: 16px;
      font-size: 12px;
      color: var(--navy);
      opacity: 0;
      transition: opacity 0.2s ease;
      font-weight: var(--font-medium);
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .case-edit-hint svg {
      flex-shrink: 0;
    }
    
    .case-card:hover .case-edit-hint {
      opacity: 1;
    }
    
    /* SVG Icons in Case-Karten */
    .case-abteilung {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .case-abteilung svg {
      flex-shrink: 0;
      stroke: var(--text-medium);
    }
    
    .case-footer span svg {
      flex-shrink: 0;
      stroke: var(--text-medium);
    }
    
    .case-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-3);
    }
    
    .case-number {
      font-size: var(--text-sm);
      font-weight: var(--font-bold);
      color: var(--navy);
    }
    
    .case-timestamp {
      font-size: var(--text-xs);
      color: var(--text-light);
    }
    
    .case-title {
      font-size: var(--text-lg);
      font-weight: var(--font-semibold);
      margin-bottom: var(--space-3);
      color: var(--text-darkest);
      line-height: var(--line-tight);
    }
    
    .case-meta {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-2);
      margin-bottom: var(--space-3);
    }
    
    .case-abteilung {
      background: var(--off-white);
      padding: var(--space-1) var(--space-3);
      border-radius: var(--border-radius-sm);
      font-size: var(--text-xs);
      color: var(--text-medium);
    }
    
    .case-relevanz {
      padding: var(--space-1) var(--space-3);
      border-radius: var(--border-radius-full);
      font-size: var(--text-xs);
      font-weight: var(--font-semibold);
    }
    
    /* Gedämpfte Status-Farben (keine Ampel!) */
    .relevanz-hoch {
      background: var(--medium-gray);
      color: var(--text-darkest);
    }
    
    .relevanz-mittel {
      background: var(--light-gray);
      color: var(--text-dark);
    }
    
    .relevanz-niedrig {
      background: var(--off-white);
      color: var(--text-medium);
    }
    
    .case-problem {
      font-size: var(--text-sm);
      color: var(--text-medium);
      margin-bottom: var(--space-4);
      line-height: var(--line-relaxed);
    }
    
    .case-footer {
      display: flex;
      justify-content: space-between;
      padding-top: var(--space-3);
      border-top: 1px solid var(--border-gray);
      font-size: var(--text-sm);
      color: var(--text-medium);
    }
    
    .case-footer span {
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }
    
    .empty-state {
      text-align: center;
      padding: var(--space-20) var(--space-10);
      background: var(--off-white);
      border-radius: var(--border-radius-lg);
      margin: var(--space-10) 0;
      border: 1px solid var(--border-gray);
    }
    
    .empty-state-icon {
      font-size: 64px;
      margin-bottom: var(--space-4);
    }
    
    .empty-state h3 {
      font-size: var(--text-2xl);
      margin-bottom: var(--space-2);
      color: var(--text-darkest);
    }
    
    .empty-state p {
      color: var(--text-medium);
      margin-bottom: var(--space-6);
    }
    
    .stats-row {
      display: flex;
      gap: var(--space-6);
      margin-bottom: var(--space-8);
    }
    
    .stat-card {
      background: var(--white);
      padding: var(--space-6);
      border-radius: var(--border-radius-lg);
      text-align: center;
      flex: 1;
      border: 1px solid var(--border-gray);
    }
    
    .stat-number {
      font-size: var(--text-5xl);
      font-weight: var(--font-bold);
      color: var(--navy);
      display: block;
    }
    
    .stat-label {
      font-size: var(--text-sm);
      color: var(--text-medium);
    }
    
    .export-bar {
      display: flex;
      justify-content: center;
      gap: var(--space-4);
      padding: var(--space-6);
      background: var(--off-white);
      border-radius: var(--border-radius-lg);
      margin-top: var(--space-10);
      border: 1px solid var(--border-gray);
    }
    
    .demo-banner {
      background: var(--banner-bg);
      border: 2px solid var(--banner-border);
      color: var(--text-darkest);
      padding: var(--space-4) var(--space-6);
      border-radius: var(--border-radius-lg);
      margin-bottom: var(--space-6);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .demo-banner p {
      margin: 0;
    }
    
    /* ============================================
       EDIT MODAL STYLES - BREITER & ELEGANTER
       ============================================ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6); /* Dunkler für besseren Kontrast */
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
    }
    
    .modal-content {
      background: var(--white);
      border-radius: 12px;
      width: 90vw; /* Responsive */
      max-width: 960px; /* VIEL BREITER! */
      max-height: 85vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: modalFadeIn 0.25s ease-out;
    }
    
    @keyframes modalFadeIn {
      from {
        opacity: 0;
        transform: scale(0.95) translateY(-20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 24px 32px;
      border-bottom: 1px solid var(--border-gray);
      position: sticky;
      top: 0;
      background: #FAFBFC;
      z-index: 10;
    }
    
    .modal-header h2 {
      margin: 0;
      font-size: 22px;
      font-weight: 600;
      color: var(--text-darkest);
    }
    
    .modal-close {
      width: 40px;
      height: 40px;
      background: transparent;
      border: none;
      font-size: 28px;
      cursor: pointer;
      color: var(--text-light);
      transition: all 0.2s ease;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .modal-close:hover {
      background: rgba(0, 0, 0, 0.08);
      color: var(--text-dark);
    }
    
    .modal-body {
      padding: 32px;
    }
    
    .modal-form-group {
      margin-bottom: 24px;
    }
    
    .modal-form-group label {
      display: block;
      font-size: 15px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
    }
    
    .modal-form-group input,
    .modal-form-group textarea,
    .modal-form-group select {
      width: 100%;
      font-size: 15px;
      padding: 12px 16px;
      border: 2px solid var(--border-gray);
      border-radius: 8px;
      font-family: var(--font-sans);
      transition: border-color 0.2s ease;
    }
    
    .modal-form-group input:focus,
    .modal-form-group textarea:focus,
    .modal-form-group select:focus {
      outline: none;
      border-color: var(--navy);
    }
    
    .modal-form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    
    /* CHECKBOX-GRID: 3 Spalten für bessere Platznutzung */
    .modal-checkbox-group {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-top: 8px;
    }
    
    .modal-checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      background: var(--off-white);
      border: 1px solid var(--border-gray);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
    }
    
    .modal-checkbox-item:hover {
      border-color: var(--navy);
      background: #F0F4F8;
    }
    
    .modal-checkbox-item input {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: var(--navy);
    }
    
    /* RADIO-GROUP: 2x2 Grid für kompaktere Darstellung */
    .modal-radio-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 8px;
    }
    
    .modal-radio-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      background: var(--off-white);
      border: 1px solid var(--border-gray);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
    }
    
    .modal-radio-item:hover {
      border-color: var(--navy);
      background: #F0F4F8;
    }
    
    .modal-radio-item input {
      width: 18px;
      height: 18px;
      cursor: pointer;
      accent-color: var(--navy);
    }
    
    /* ZWEI-SPALTEN LAYOUT für kurze Felder */
    .modal-form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 24px;
    }
    
    .modal-form-row .modal-form-group {
      margin-bottom: 0;
    }
    
    .modal-footer {
      display: flex;
      gap: 12px;
      padding: 20px 32px;
      border-top: 1px solid var(--border-gray);
      justify-content: flex-end;
      position: sticky;
      bottom: 0;
      background: #FAFBFC;
    }
    
    .modal-section-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--navy);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--navy);
    }
    
    /* Responsive für kleinere Bildschirme */
    @media (max-width: 768px) {
      .modal-content {
        width: 95vw;
        max-height: 90vh;
      }
      
      .modal-header,
      .modal-body,
      .modal-footer {
        padding: 16px 20px;
      }
      
      .modal-checkbox-group {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .modal-radio-group {
        grid-template-columns: 1fr;
      }
      
      .modal-form-row {
        grid-template-columns: 1fr;
        gap: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="page-wrapper">
    
    <!-- NEUER HEADER -->
    <header class="main-header">
      <div class="header-container">
        <div class="header-left">
          <div class="logo-group">
            <img src="../assets/gannaca-logo.png" alt="gannaca" class="gannaca-logo">
            <div class="title-group">
              <h1 class="main-title">gannaca AI Case Sprint</h1>
              <p class="subtitle">Standardisiertes Framework für KI-Use-Case-Entwicklung</p>
            </div>
          </div>
        </div>
        <div class="header-right">
          <img src="../assets/trianel-logo.png" alt="Trianel" class="client-logo">
          <div class="header-info">
            <span class="version-badge">04.02.2026</span>
          </div>
        </div>
      </div>
    </header>
    
    <div class="terminology-mandatory">
      DATENSCHUTZ-KONFORM – KEINE PRODUKTIVDATEN<br>
      Dieses Mockup dient ausschließlich zur Visualisierung.<br>
      Alle gezeigten Beispiele sind fiktiv. Keine Erfassung,<br>
      Verarbeitung oder Speicherung von produktiven Trianel-Daten.
    </div>
    <!-- TERMINOLOGIE-COMPLIANT -->
    
    <!-- NAVIGATION -->
    <nav class="nav-tabs">
      <div class="nav-tabs-inner">
        <a href="screen-0-workshop-process.html" class="nav-tab"><span class="nav-tab-number">0</span> Workshop-Prozess</a>
        <a href="screen-1-overview.html" class="nav-tab"><span class="nav-tab-number">1</span> Übersicht</a>
        <a href="screen-2-kpi.html" class="nav-tab nav-tab-optional"><span class="nav-tab-number">2</span> KPI-Rahmen</a>
        <a href="screen-3-governance.html" class="nav-tab"><span class="nav-tab-number">3</span> Governance</a>
        <a href="screen-4-process.html" class="nav-tab nav-tab-optional"><span class="nav-tab-number">4</span> Zielprozess</a>
        <a href="screen-5-mockup.html" class="nav-tab nav-tab-optional"><span class="nav-tab-number">5</span> Visualisierung</a>
        <a href="screen-6-form.html" class="nav-tab"><span class="nav-tab-number">6</span> Case-Erfassung <i data-lucide="star" class="icon-sm"></i></a>
        <a href="screen-6b-bewertung.html" class="nav-tab"><span class="nav-tab-number">6b</span> Bewertung</a>
        <a href="screen-7-results.html" class="nav-tab active"><span class="nav-tab-number">7</span> Ergebnis</a>
        <a href="screen-8-matrix.html" class="nav-tab"><span class="nav-tab-number">8</span> Matrix</a>
      </div>
    </nav>
    
    <!-- MAIN CONTENT -->
    <main class="main-content">
      
      <!-- SLIDE CONTAINER (scrollbar wegen variabler Case-Anzahl) -->
      <div class="slide-container" style="overflow-y: auto; max-height: none;">
        
        <!-- SLIDE HEADER -->
        <div class="slide-header">
          <h1><i data-lucide="bar-chart-3" style="width:26px;height:26px;"></i>Workshop-Ergebnis: Longlist
            <span id="caseCountBadge" class="case-count-badge" style="display: inline-flex; align-items: center; justify-content: center; background: var(--navy); color: white; font-size: 20px; font-weight: 700; padding: 4px 16px; border-radius: 20px; margin-left: 12px; min-width: 48px;"><span id="caseCountTitle">0</span> Cases</span>
          </h1>
          <p>Dokumentierte Problemfälle – bereit für Bewertung & Priorisierung</p>
        </div>
        
        <!-- SLIDE CONTENT -->
        <div class="slide-content">
        
        <!-- Demo-Daten Banner (nur wenn leer) -->
        <div class="demo-banner" id="demoBanner" style="display: none;">
          <p><strong>Keine Cases vorhanden.</strong> Möchten Sie Demo-Daten laden, um die Ansicht zu testen?</p>
          <button class="btn btn-primary" onclick="loadDemo()">Demo-Daten laden</button>
        </div>
        
        <!-- Statistics -->
        <div class="stats-row" id="statsRow">
          <div class="stat-card">
            <span class="stat-number" id="totalCases">0</span>
            <span class="stat-label">Erfasste Cases</span>
          </div>
          <div class="stat-card">
            <span class="stat-number" id="totalDepartments">0</span>
            <span class="stat-label">Abteilungen beteiligt</span>
          </div>
          <div class="stat-card">
            <span class="stat-number" id="highPriority">0</span>
            <span class="stat-label">Hohe Relevanz</span>
          </div>
          <div class="stat-card">
            <span class="stat-number" id="avgRisk">-</span>
            <span class="stat-label">Ø Risiko-Score</span>
          </div>
        </div>
        
        <!-- STATUS-BOX (nur wenn Cases vorhanden) -->
        <div class="box" id="successBox" style="margin-bottom: 32px; display: none; background: var(--off-white); border: 1px solid var(--border-gray); padding: var(--space-6); border-radius: var(--border-radius-lg);">
          <h3 style="font-size: var(--text-base); font-weight: var(--font-semibold); color: var(--text-darkest); margin-bottom: var(--space-3);">Status: Erfassung abgeschlossen</h3>
          <p style="margin: 0; color: var(--text-medium);">Alle Cases wurden strukturiert erfasst und sind bereit für die KI-gestützte Analyse. Die Priorisierungs-Matrix wird im Anschluss erstellt.</p>
        </div>
        
        <!-- CASES GRID -->
        <div id="casesContainer"></div>
        
        <!-- EMPTY STATE -->
        <div class="empty-state" id="emptyState" style="display: none;">
          <div class="empty-state-icon"><i data-lucide="clipboard-list" class="icon-2xl icon-muted"></i></div>
          <h3>Noch keine Cases erfasst</h3>
          <p>Noch keine Cases erfasst.<br>
          <span style="color: var(--text-light); font-size: 14px;">Tab „Case-Erfassung" → ersten Case dokumentieren.</span></p>
          <div style="display: flex; gap: 12px; justify-content: center; margin-top: 16px;">
            <a href="screen-6-form.html" class="btn btn-primary btn-lg"><i data-lucide="plus" class="icon-sm"></i> Ersten Case erfassen</a>
            <button class="btn btn-secondary" onclick="loadDemo()"><i data-lucide="database" class="icon-sm"></i> Demo-Daten laden</button>
          </div>
        </div>
        
        <!-- NÄCHSTE SCHRITTE -->
        <div class="box" id="nextStepsBox" style="margin-top: 40px; display: none; background: var(--off-white); border: 1px solid var(--border-gray); padding: var(--space-6); border-radius: var(--border-radius-lg);">
          <h3 style="font-size: var(--text-base); font-weight: var(--font-semibold); color: var(--text-darkest); margin-bottom: var(--space-4);">Nächste Schritte</h3>
          <p style="margin-bottom: 12px; color: var(--text-medium);"><strong>KI-Analyse (Phase 2):</strong></p>
          <ol style="margin: 0; padding-left: 24px; color: var(--text-medium);">
            <li style="padding: 4px 0;">Nutzen-Risiko-Bewertung (automatisiert)</li>
            <li style="padding: 4px 0;">Machbarkeits-Einschätzung</li>
            <li style="padding: 4px 0;">Identifikation Top-3 Cases</li>
            <li style="padding: 4px 0;">Empfehlung für finalen Case</li>
          </ol>
          <p style="margin-top: 16px; margin-bottom: 0;"><strong style="color: var(--navy);">Ergebnis folgt per E-Mail.</strong></p>
        </div>
        
        <!-- EXPORT BAR -->
        <div class="export-bar" id="exportBar" style="display: none; flex-direction: column; gap: 16px;">
          <!-- PRIMÄRE AKTION: Export für Evaluator -->
          <div style="display: flex; align-items: center; gap: 16px; padding-bottom: 16px; border-bottom: 1px solid var(--border-gray);">
            <button class="btn btn-primary btn-lg" onclick="exportForEvaluator()" style="display: flex; align-items: center; gap: 8px;">
              <i data-lucide="sparkles" class="icon-sm"></i>
              Export für AI Case Evaluator
            </button>
            <span style="color: var(--text-medium); font-size: 14px;">→ Daten für KI-gestützte Bewertung exportieren</span>
          </div>
          <!-- SEKUNDÄRE OPTIONEN -->
          <div style="display: flex; justify-content: center; gap: 12px;">
            <span style="color: var(--text-light); font-size: 13px; margin-right: 8px;">Weitere Optionen:</span>
            <button class="btn btn-secondary btn-sm" onclick="exportAsJSON()"><i data-lucide="file-text" class="icon-sm"></i> JSON-Backup</button>
            <button class="btn btn-secondary btn-sm" onclick="window.print()"><i data-lucide="printer" class="icon-sm"></i> Drucken</button>
            <button class="btn btn-tertiary btn-sm" onclick="confirmClearAll()"><i data-lucide="trash-2" class="icon-sm"></i> Alle löschen</button>
          </div>
        </div>
        
        </div><!-- /slide-content -->
        
        <!-- SLIDE FOOTER -->
        <div class="slide-footer" style="margin-top: 24px;">
          <a href="screen-6-form.html" class="btn btn-primary">+ Neuen Case erfassen</a>
          <a href="screen-8-matrix.html" class="btn btn-secondary">Zur Priorisierungs-Matrix →</a>
        </div>
        
      </div><!-- /slide-container -->
      
    </main>
    
    <!-- FOOTER -->
    <footer class="footer">
      <div class="footer-inner">
        <span>© 2026 gannaca AI Case Sprint</span>
      </div>
    </footer>
    
  </div><!-- /page-wrapper -->
  
  <!-- ============================================
       EDIT MODAL
       ============================================ -->
  <div id="editModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      
      <div class="modal-header">
        <h2>Case <span id="editCaseNumber">#01</span> bearbeiten</h2>
        <button class="modal-close" onclick="closeEditModal()">&times;</button>
      </div>
      
      <div class="modal-body">
        
        <!-- 1. PROBLEM-TITEL -->
        <div class="modal-form-group">
          <label>1. Problem-Titel *</label>
          <input type="text" id="edit-problemTitel" placeholder="Kurzer, prägnanter Titel">
        </div>
        
        <!-- 2. ABTEILUNGEN -->
        <div class="modal-form-group">
          <label>2. Betroffene Abteilung(en)</label>
          <div class="modal-checkbox-group" id="edit-abteilungen">
            <label class="modal-checkbox-item"><input type="checkbox" name="edit-abteilung" value="Legal"> Legal</label>
            <label class="modal-checkbox-item"><input type="checkbox" name="edit-abteilung" value="Compliance"> Compliance</label>
            <label class="modal-checkbox-item"><input type="checkbox" name="edit-abteilung" value="Revision"> Revision</label>
            <label class="modal-checkbox-item"><input type="checkbox" name="edit-abteilung" value="IT"> IT</label>
            <label class="modal-checkbox-item"><input type="checkbox" name="edit-abteilung" value="HR"> HR</label>
            <label class="modal-checkbox-item"><input type="checkbox" name="edit-abteilung" value="Finance"> Finance</label>
          </div>
        </div>
        
        <!-- 3. AUSGANGSLAGE -->
        <div class="modal-form-group">
          <label>3. Ausgangslage / Ist-Zustand *</label>
          <textarea id="edit-ausgangslage" placeholder="Wie läuft der Prozess aktuell?"></textarea>
        </div>
        
        <!-- 4. KONKRETES PROBLEM -->
        <div class="modal-form-group">
          <label>4. Konkretes Problem / Engpass *</label>
          <textarea id="edit-problem" placeholder="Was genau ist das Problem?"></textarea>
        </div>
        
        <!-- 5. HÄUFIGKEIT / VOLUMEN -->
        <div class="modal-form-group">
          <label>5. Häufigkeit / Volumen</label>
          <div class="modal-radio-group">
            <label class="modal-radio-item"><input type="radio" name="edit-haeufigkeit" value="Täglich"> Täglich</label>
            <label class="modal-radio-item"><input type="radio" name="edit-haeufigkeit" value="Wöchentlich"> Wöchentlich</label>
            <label class="modal-radio-item"><input type="radio" name="edit-haeufigkeit" value="Monatlich"> Monatlich</label>
            <label class="modal-radio-item"><input type="radio" name="edit-haeufigkeit" value="Quartalsweise"> Quartalsweise</label>
          </div>
          <div style="margin-top: 12px;">
            <label style="font-weight: normal; font-size: 14px;">Anzahl Vorgänge pro Zeiteinheit:</label>
            <input type="number" id="edit-anzahlVorgaenge" placeholder="z.B. 50" style="width: 150px; margin-top: 4px;">
          </div>
        </div>
        
        <!-- 6. PERSONEN & ZEITAUFWAND -->
        <div class="modal-form-group">
          <label>6. Betroffene Personen & Zeitaufwand</label>
          <div class="modal-form-row">
            <div>
              <label style="font-weight: normal; font-size: 14px;">Anzahl Mitarbeiter:</label>
              <input type="number" id="edit-betroffenePersonen" placeholder="z.B. 3">
            </div>
            <div>
              <label style="font-weight: normal; font-size: 14px;">Zeitaufwand pro Fall:</label>
              <div style="display: flex; gap: 8px;">
                <input type="number" id="edit-zeitaufwandWert" placeholder="25" style="width: 80px;">
                <select id="edit-zeitaufwandEinheit" style="width: auto;">
                  <option value="minutes">Minuten</option>
                  <option value="hours">Stunden</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 7. STRATEGISCHE RELEVANZ -->
        <div class="modal-form-group">
          <label>7. Strategische Relevanz</label>
          <div class="modal-radio-group">
            <label class="modal-radio-item"><input type="radio" name="edit-relevanz" value="Hoch"> ■ Hoch</label>
            <label class="modal-radio-item"><input type="radio" name="edit-relevanz" value="Mittel"> ▪ Mittel</label>
            <label class="modal-radio-item"><input type="radio" name="edit-relevanz" value="Niedrig"> ○ Niedrig</label>
          </div>
        </div>
        
        <!-- 8. RISIKO -->
        <div class="modal-form-group">
          <label>8. Risiko bei Nicht-Handlung (1-5)</label>
          <div class="modal-radio-group">
            <label class="modal-radio-item"><input type="radio" name="edit-risiko" value="1"> 1</label>
            <label class="modal-radio-item"><input type="radio" name="edit-risiko" value="2"> 2</label>
            <label class="modal-radio-item"><input type="radio" name="edit-risiko" value="3"> 3</label>
            <label class="modal-radio-item"><input type="radio" name="edit-risiko" value="4"> 4</label>
            <label class="modal-radio-item"><input type="radio" name="edit-risiko" value="5"> 5</label>
          </div>
          <div style="margin-top: 12px;">
            <label style="font-weight: normal; font-size: 14px;">Begründung (optional):</label>
            <textarea id="edit-risikoBegruendung" placeholder="z.B. Audit-Findings, Reputationsrisiko..." style="min-height: 60px;"></textarea>
          </div>
        </div>
        
        <!-- 9. VORHANDENE LÖSUNGEN -->
        <div class="modal-form-group">
          <label>9. Vorhandene Lösungsansätze</label>
          <div class="modal-radio-group">
            <label class="modal-radio-item"><input type="radio" name="edit-vorhandeneLoesung" value="yes"> Ja</label>
            <label class="modal-radio-item"><input type="radio" name="edit-vorhandeneLoesung" value="no"> Nein</label>
          </div>
          <div style="margin-top: 12px;">
            <label style="font-weight: normal; font-size: 14px;">Falls ja, Beschreibung:</label>
            <input type="text" id="edit-vorhandeneLösungBeschreibung" placeholder="z.B. Excel-Makro, SharePoint-Workflow...">
          </div>
        </div>
        
        <!-- 10. DATEN-VERFÜGBARKEIT -->
        <div class="modal-form-group">
          <label>10. Daten-Verfügbarkeit</label>
          <div class="modal-radio-group">
            <label class="modal-radio-item"><input type="radio" name="edit-datenVerfuegbarkeit" value="full_digital"><i data-lucide="check-circle" class="icon-sm icon-success"></i> Vollständig digital</label>
            <label class="modal-radio-item"><input type="radio" name="edit-datenVerfuegbarkeit" value="partial"><i data-lucide="alert-triangle" class="icon-sm icon-warning"></i> Teilweise digital</label>
            <label class="modal-radio-item"><input type="radio" name="edit-datenVerfuegbarkeit" value="paper"><i data-lucide="file-text" class="icon-sm icon-muted"></i> Überwiegend Papier</label>
            <label class="modal-radio-item"><input type="radio" name="edit-datenVerfuegbarkeit" value="unclear"> ❓ Unklar</label>
          </div>
        </div>
        
        <!-- 11. KI-POTENZIAL -->
        <div class="modal-form-group">
          <label>11. KI-Potenzial (Optional)</label>
          <textarea id="edit-kiPotenzial" placeholder="Wo könnte KI theoretisch unterstützen?"></textarea>
        </div>
        
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeEditModal()">Abbrechen</button>
        <button class="btn btn-primary" onclick="saveEditedCase()"><i data-lucide="save" class="icon-sm"></i> Speichern & Schließen</button>
      </div>
      
    </div>
  </div>
  
  <!-- JAVASCRIPT -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      renderCases();
      
      // Markiere aktuellen Tab als "active"
      const currentPage = window.location.pathname.split('/').pop();
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('href') === currentPage) {
          tab.classList.add('active');
        }
      });
    });
    
    function renderCases() {
      const cases = getAllCases();
      const container = document.getElementById('casesContainer');
      
      // Update title
      document.getElementById('caseCountTitle').textContent = cases.length;
      document.getElementById('totalCases').textContent = cases.length;
      
      if (cases.length === 0) {
        document.getElementById('emptyState').style.display = 'block';
        document.getElementById('demoBanner').style.display = 'flex';
        document.getElementById('successBox').style.display = 'none';
        document.getElementById('nextStepsBox').style.display = 'none';
        document.getElementById('exportBar').style.display = 'none';
        document.getElementById('statsRow').style.display = 'none';
        container.innerHTML = '';
        return;
      }
      
      // Show elements
      document.getElementById('emptyState').style.display = 'none';
      document.getElementById('demoBanner').style.display = 'none';
      document.getElementById('successBox').style.display = 'block';
      document.getElementById('nextStepsBox').style.display = 'block';
      document.getElementById('exportBar').style.display = 'flex';
      document.getElementById('statsRow').style.display = 'flex';
      
      // Calculate stats
      const allDepartments = new Set();
      let highPriorityCount = 0;
      let totalRisk = 0;
      let riskCount = 0;
      
      cases.forEach(c => {
        if (c.abteilungen) {
          c.abteilungen.forEach(a => allDepartments.add(a));
        }
        if (c.strategischeRelevanz === 'Hoch') highPriorityCount++;
        if (c.risiko) {
          totalRisk += parseInt(c.risiko);
          riskCount++;
        }
      });
      
      document.getElementById('totalDepartments').textContent = allDepartments.size;
      document.getElementById('highPriority').textContent = highPriorityCount;
      document.getElementById('avgRisk').textContent = riskCount > 0 ? (totalRisk / riskCount).toFixed(1) : '-';
      
      // Render cards
      let html = '<div class="cases-grid">';
      
      cases.forEach((caseItem, index) => {
        const relevanzClass = caseItem.strategischeRelevanz ? `relevanz-${caseItem.strategischeRelevanz.toLowerCase()}` : '';
        const abteilungen = caseItem.abteilungen ? caseItem.abteilungen.join(', ') : 'Nicht angegeben';
        const problemText = caseItem.problem ? (caseItem.problem.length > 120 ? caseItem.problem.substring(0, 120) + '...' : caseItem.problem) : 'Keine Beschreibung';
        
        html += `
          <div class="case-card" onclick="editCase(${caseItem.caseNumber})">
            <div class="case-edit-hint">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
              Klicken zum Bearbeiten
            </div>
            <div class="case-card-header">
              <span class="case-number">CASE #${caseItem.caseNumber.toString().padStart(2, '0')}</span>
              <span class="case-timestamp">${caseItem.timestamp || ''}</span>
            </div>
            <h4 class="case-title">${caseItem.problemTitel || 'Kein Titel'}</h4>
            <div class="case-meta">
              <span class="case-abteilung">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg>
                ${abteilungen}
              </span>
              ${caseItem.strategischeRelevanz ? `<span class="case-relevanz ${relevanzClass}">${caseItem.strategischeRelevanz}</span>` : ''}
            </div>
            <p class="case-problem">${problemText}</p>
            <div class="case-footer">
              <span>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                  <line x1="12" y1="9" x2="12" y2="13"></line>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                Risiko: ${caseItem.risiko || '-'}/5
              </span>
              <span>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                  <line x1="16" y1="2" x2="16" y2="6"></line>
                  <line x1="8" y1="2" x2="8" y2="6"></line>
                  <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                ${caseItem.haeufigkeit || '-'}
              </span>
              <span>
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                  <circle cx="9" cy="7" r="4"></circle>
                  <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                  <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                ${caseItem.betroffenePersonen || '-'} Pers.
              </span>
            </div>
          </div>
        `;
      });
      
      html += '</div>';
      container.innerHTML = html;
    }
    
    function loadDemo() {
      if (confirm('Demo-Daten laden? Dies überschreibt keine vorhandenen Daten.')) {
        loadDemoData();
        renderCases();
      }
    }
    
    function confirmClearAll() {
      if (confirm('⚠️ ACHTUNG: Wirklich ALLE Cases löschen?\n\nDiese Aktion kann nicht rückgängig gemacht werden!')) {
        if (confirm('Sind Sie sicher? Alle erfassten Daten gehen verloren.')) {
          clearAllCases();
          renderCases();
        }
      }
    }
    
    function exportAsJSON() {
      const data = exportCasesAsJSON();
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `gannaca-cases-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }

    // ============================================
    // EXPORT FÜR AI CASE EVALUATOR
    // Strukturiert die Daten für KI-Bewertung
    // ============================================
    function exportForEvaluator() {
      const cases = getAllCases();

      if (cases.length === 0) {
        toastWarning('Keine Daten', 'Es sind keine Cases zum Exportieren vorhanden.');
        return;
      }

      // Cases für Evaluator formatieren
      const evaluatorData = {
        meta: {
          exportDate: new Date().toISOString(),
          source: 'gannaca AI Case Sprint Framework',
          version: '1.0',
          totalCases: cases.length
        },
        cases: cases.map(c => ({
          // PFLICHTFELDER für Evaluator
          caseId: c.caseNumber,
          problemTitel: c.problemTitel || '',
          abteilungen: c.abteilungen || [],
          ausgangslage: c.ausgangslage || '',
          problem: c.problem || '',
          haeufigkeit: c.haeufigkeit || '',
          volumen: c.anzahlVorgaenge || '',
          zeitaufwand: {
            wert: c.zeitaufwandWert || '',
            einheit: c.zeitaufwandEinheit || 'minutes'
          },
          betroffenePersonen: c.betroffenePersonen || '',
          risiko: c.risiko || '',
          datenVerfuegbarkeit: c.datenVerfuegbarkeit || '',

          // GOVERNANCE-TRIGGER
          governanceTrigger: {
            entscheidungswirkung: c.governanceTrigger?.entscheidungswirkung || 'nein',
            kritisRelevanz: c.governanceTrigger?.kritisRelevanz || 'nein',
            personenbezogen: c.governanceTrigger?.personenbezogen || 'nein',
            automationsgrad: c.governanceTrigger?.automationsgrad || 'nein'
          },

          // OPTIONALE FELDER
          optional: {
            tools: c.tools || [],
            strategischeRelevanz: c.strategischeRelevanz || '',
            kiPotenzial: c.kiPotenzial || '',
            risikoBegruendung: c.risikoBegruendung || ''
          }
        }))
      };

      // JSON erstellen und downloaden
      const jsonString = JSON.stringify(evaluatorData, null, 2);
      const blob = new Blob([jsonString], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `evaluator-input-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      URL.revokeObjectURL(url);

      // Erfolgsmeldung mit Hinweis
      toastSuccess(
        'Export erfolgreich',
        `${cases.length} Case(s) für AI Case Evaluator exportiert. Datei kann jetzt im Evaluator importiert werden.`
      );
    }
    
    // ============================================
    // CASE EDIT FUNKTIONEN
    // ============================================
    
    // Case zum Bearbeiten öffnen
    function editCase(caseNumber) {
      const cases = getAllCases();
      const caseData = cases.find(c => c.caseNumber === caseNumber);
      
      if (!caseData) {
        toastError('Fehler', 'Case nicht gefunden!');
        return;
      }
      
      const modal = document.getElementById('editModal');
      
      // Case-Nummer im Header anzeigen
      document.getElementById('editCaseNumber').textContent = '#' + caseNumber.toString().padStart(2, '0');
      modal.dataset.caseNumber = caseNumber;
      
      // Felder befüllen
      document.getElementById('edit-problemTitel').value = caseData.problemTitel || '';
      document.getElementById('edit-ausgangslage').value = caseData.ausgangslage || '';
      document.getElementById('edit-problem').value = caseData.problem || '';
      document.getElementById('edit-anzahlVorgaenge').value = caseData.anzahlVorgaenge || '';
      document.getElementById('edit-betroffenePersonen').value = caseData.betroffenePersonen || '';
      document.getElementById('edit-zeitaufwandWert').value = caseData.zeitaufwandWert || '';
      document.getElementById('edit-zeitaufwandEinheit').value = caseData.zeitaufwandEinheit || 'minutes';
      document.getElementById('edit-risikoBegruendung').value = caseData.risikoBegruendung || '';
      document.getElementById('edit-vorhandeneLösungBeschreibung').value = caseData.vorhandeneLösungBeschreibung || '';
      document.getElementById('edit-kiPotenzial').value = caseData.kiPotenzial || '';
      
      // Checkboxen für Abteilungen
      document.querySelectorAll('input[name="edit-abteilung"]').forEach(cb => {
        cb.checked = caseData.abteilungen && caseData.abteilungen.includes(cb.value);
      });
      
      // Radio-Buttons
      setRadioValue('edit-haeufigkeit', caseData.haeufigkeit);
      setRadioValue('edit-relevanz', caseData.strategischeRelevanz);
      setRadioValue('edit-risiko', caseData.risiko);
      setRadioValue('edit-vorhandeneLoesung', caseData.vorhandeneLoesung);
      setRadioValue('edit-datenVerfuegbarkeit', caseData.datenVerfuegbarkeit);
      
      // Modal anzeigen
      modal.style.display = 'flex';
      
      // Body Scroll verhindern
      document.body.style.overflow = 'hidden';
    }
    
    // Helper: Radio-Button setzen
    function setRadioValue(name, value) {
      if (!value) return;
      const radio = document.querySelector(`input[name="${name}"][value="${value}"]`);
      if (radio) radio.checked = true;
    }
    
    // Helper: Radio-Button Wert auslesen
    function getRadioValue(name) {
      const checked = document.querySelector(`input[name="${name}"]:checked`);
      return checked ? checked.value : '';
    }
    
    // Case speichern
    function saveEditedCase() {
      const modal = document.getElementById('editModal');
      const caseNumber = parseInt(modal.dataset.caseNumber);
      
      // Daten sammeln
      const updatedData = {
        problemTitel: document.getElementById('edit-problemTitel').value,
        abteilungen: Array.from(document.querySelectorAll('input[name="edit-abteilung"]:checked')).map(cb => cb.value),
        ausgangslage: document.getElementById('edit-ausgangslage').value,
        problem: document.getElementById('edit-problem').value,
        haeufigkeit: getRadioValue('edit-haeufigkeit'),
        anzahlVorgaenge: document.getElementById('edit-anzahlVorgaenge').value,
        betroffenePersonen: document.getElementById('edit-betroffenePersonen').value,
        zeitaufwandWert: document.getElementById('edit-zeitaufwandWert').value,
        zeitaufwandEinheit: document.getElementById('edit-zeitaufwandEinheit').value,
        strategischeRelevanz: getRadioValue('edit-relevanz'),
        risiko: getRadioValue('edit-risiko'),
        risikoBegruendung: document.getElementById('edit-risikoBegruendung').value,
        vorhandeneLoesung: getRadioValue('edit-vorhandeneLoesung'),
        vorhandeneLösungBeschreibung: document.getElementById('edit-vorhandeneLösungBeschreibung').value,
        datenVerfuegbarkeit: getRadioValue('edit-datenVerfuegbarkeit'),
        kiPotenzial: document.getElementById('edit-kiPotenzial').value
      };
      
      // Validierung
      if (!updatedData.problemTitel.trim()) {
        toastWarning('Pflichtfeld fehlt', 'Bitte geben Sie einen Problem-Titel ein.');
        document.getElementById('edit-problemTitel').focus();
        return;
      }
      
      // In localStorage aktualisieren
      const cases = getAllCases();
      const index = cases.findIndex(c => c.caseNumber === caseNumber);
      
      if (index !== -1) {
        // Bestehende Daten mit Updates zusammenführen
        cases[index] = { ...cases[index], ...updatedData };
        localStorage.setItem('gannaca_cases', JSON.stringify(cases));
        
        // Modal schließen
        closeEditModal();
        
        // Übersicht neu laden
        renderCases();
        
        // Erfolgsmeldung
        toastSuccess(`Case #${caseNumber.toString().padStart(2, '0')} aktualisiert`, 'Änderungen wurden gespeichert.');
      } else {
        toastError('Fehler', 'Case konnte nicht gefunden werden.');
      }
    }
    
    // Modal schließen
    function closeEditModal() {
      const modal = document.getElementById('editModal');
      modal.style.display = 'none';
      document.body.style.overflow = '';
    }
    
    // ESC-Taste zum Schließen
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeEditModal();
      }
    });
    
    // Klick außerhalb des Modals zum Schließen
    document.getElementById('editModal')?.addEventListener('click', function(e) {
      if (e.target === this) {
        closeEditModal();
      }
    });
  </script>
  
  <!-- Initialize Lucide Icons -->
  <script>lucide.createIcons();</script>
</body>
</html>
