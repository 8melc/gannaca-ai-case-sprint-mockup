<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Workshop-Ergebnis | gannaca AI Case Sprint</title>

  <!-- Styles -->
  <link rel="stylesheet" href="../styles/variables.css">
  <link rel="stylesheet" href="../styles/main.css">
  <link rel="stylesheet" href="../styles/components.css">

  <!-- Google Fonts (Inter) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Storage Script -->
  <script src="../js/storage.js"></script>

  <!-- Toast Notification System -->
  <script src="../js/toast.js"></script>

  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>

  <style>
    /* ============================================
       BEAMER-OPTIMIERTES LAYOUT
       Auf einen Blick, ohne Scrollen
       ============================================ */

    .results-layout {
      width: 100%;
      max-width: 1500px;
      padding: 48px 80px 40px;
      box-sizing: border-box;
      min-height: calc(100vh - var(--header-height) - var(--nav-height));
      display: flex;
      flex-direction: column;
      margin: 0 auto;
    }

    /* Header */
    .results-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 2px solid var(--navy);
    }

    .results-header h1 {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-darkest);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .case-count-badge {
      background: var(--navy);
      color: white;
      font-size: 20px;
      font-weight: 700;
      padding: 6px 16px;
      border-radius: 20px;
    }

    .results-header p {
      font-size: 16px;
      color: var(--text-medium);
      margin: 4px 0 0;
    }

    /* Stats Grid - Prominent */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 24px;
    }

    .stat-card {
      background: white;
      border: 2px solid var(--border-gray);
      border-radius: 12px;
      padding: 20px 24px;
      text-align: center;
    }

    .stat-number {
      font-size: 48px;
      font-weight: 700;
      color: var(--navy);
      display: block;
      line-height: 1.1;
    }

    .stat-label {
      font-size: 14px;
      color: var(--text-medium);
      margin-top: 4px;
    }

    /* Cases Preview - Alle Cards */
    .cases-preview {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
      max-height: 50vh;
      overflow-y: auto;
      padding-right: 8px;
    }

    .case-card {
      background: white;
      border: 2px solid var(--border-gray);
      border-radius: 12px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      transition: all 0.2s;
    }

    .case-card:hover {
      border-color: var(--navy);
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .case-edit-hint {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border-gray);
      font-size: 12px;
      font-weight: 600;
      color: var(--navy);
      opacity: 0;
      transition: opacity 0.2s;
    }

    .case-card:hover .case-edit-hint {
      opacity: 1;
    }

    .case-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .case-number {
      font-size: 13px;
      font-weight: 700;
      color: var(--navy);
    }

    .case-relevanz {
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }

    .relevanz-hoch {
      background: var(--medium-gray);
      color: var(--text-darkest);
    }

    .relevanz-mittel {
      background: var(--light-gray);
      color: var(--text-dark);
    }

    .case-title {
      font-size: 17px;
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--text-darkest);
      line-height: 1.3;
    }

    .case-abteilung {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--off-white);
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 12px;
      color: var(--text-medium);
      margin-bottom: 10px;
    }

    .case-problem {
      font-size: 13px;
      color: var(--text-medium);
      line-height: 1.5;
      flex: 1;
    }

    .case-footer {
      display: flex;
      justify-content: space-between;
      padding-top: 12px;
      border-top: 1px solid var(--border-gray);
      margin-top: 12px;
      font-size: 13px;
      color: var(--text-medium);
    }

    .case-footer span {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* More Cases Indicator */
    .more-cases {
      text-align: center;
      padding: 16px;
      background: var(--off-white);
      border-radius: 12px;
      color: var(--text-medium);
      font-size: 14px;
    }

    .more-cases strong {
      color: var(--navy);
    }

    /* Status & Next Steps */
    .bottom-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .status-box {
      background: var(--off-white);
      border: 1px solid var(--border-gray);
      border-radius: 12px;
      padding: 20px;
    }

    .status-box h3 {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-darkest);
      margin: 0 0 8px 0;
    }

    .status-box p {
      font-size: 13px;
      color: var(--text-medium);
      margin: 0;
      line-height: 1.5;
    }

    .next-steps-list {
      margin: 8px 0 0;
      padding-left: 20px;
      font-size: 13px;
      color: var(--text-medium);
    }

    .next-steps-list li {
      padding: 3px 0;
    }

    /* Export Bar */
    .export-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 12px;
      padding: 16px;
      background: var(--off-white);
      border: 1px solid var(--border-gray);
      border-radius: 12px;
    }

    /* Footer Nav */
    .results-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid var(--border-gray);
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 40px;
      background: var(--off-white);
      border-radius: 12px;
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .empty-state h3 {
      font-size: 24px;
      margin: 16px 0 8px;
      color: var(--text-darkest);
    }

    .empty-state p {
      color: var(--text-medium);
      margin-bottom: 20px;
    }

    /* Beamer Optimierung */
    @media screen and (min-width: 1920px) {
      .results-layout {
        padding: 28px 60px 24px;
      }

      .results-header h1 {
        font-size: 32px;
      }

      .stat-number {
        font-size: 56px;
      }

      .stat-label {
        font-size: 16px;
      }

      .case-title {
        font-size: 19px;
      }
    }

    @media (max-width: 1440px) {
      .results-layout {
        padding: 20px 32px 16px;
      }

      .stats-grid {
        gap: 16px;
      }

      .stat-number {
        font-size: 40px;
      }

      .cases-preview {
        gap: 16px;
      }
    }

    /* ============================================
       INLINE CASE EDIT PANEL
       ============================================ */
    .edit-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      overflow-y: auto;
      padding: 40px 20px;
    }

    .edit-overlay.active {
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .edit-panel {
      background: white;
      border-radius: 16px;
      width: 100%;
      max-width: 900px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }

    .edit-panel-header {
      position: sticky;
      top: 0;
      background: var(--navy);
      color: white;
      padding: 20px 28px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 16px 16px 0 0;
      z-index: 10;
    }

    .edit-panel-header h2 {
      margin: 0;
      font-size: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .edit-panel-close {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .edit-panel-close:hover {
      background: rgba(255,255,255,0.3);
    }

    .edit-panel-body {
      padding: 28px;
    }

    .edit-section {
      margin-bottom: 24px;
      padding-bottom: 24px;
      border-bottom: 1px solid var(--border-gray);
    }

    .edit-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }

    .edit-section-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--navy);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .edit-section-title .section-num {
      background: var(--navy);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    .edit-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .edit-grid.single {
      grid-template-columns: 1fr;
    }

    .edit-field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .edit-field.full-width {
      grid-column: 1 / -1;
    }

    .edit-label {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-medium);
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .edit-input,
    .edit-textarea,
    .edit-select {
      padding: 10px 14px;
      border: 2px solid var(--border-gray);
      border-radius: 8px;
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.2s;
    }

    .edit-input:focus,
    .edit-textarea:focus,
    .edit-select:focus {
      outline: none;
      border-color: var(--navy);
    }

    .edit-textarea {
      min-height: 80px;
      resize: vertical;
    }

    .edit-checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .edit-checkbox-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--off-white);
      border: 2px solid var(--border-gray);
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }

    .edit-checkbox-item:has(input:checked) {
      background: var(--navy);
      border-color: var(--navy);
      color: white;
    }

    .edit-checkbox-item input {
      display: none;
    }

    .edit-radio-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .edit-radio-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--off-white);
      border: 2px solid var(--border-gray);
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }

    .edit-radio-item:has(input:checked) {
      background: var(--navy);
      border-color: var(--navy);
      color: white;
    }

    .edit-radio-item input {
      display: none;
    }

    .edit-rating-group {
      display: flex;
      gap: 8px;
    }

    .edit-rating-item {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--off-white);
      border: 2px solid var(--border-gray);
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 700;
      transition: all 0.2s;
    }

    .edit-rating-item:has(input:checked) {
      background: var(--navy);
      border-color: var(--navy);
      color: white;
    }

    .edit-rating-item input {
      display: none;
    }

    .edit-panel-footer {
      position: sticky;
      bottom: 0;
      background: var(--off-white);
      padding: 20px 28px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid var(--border-gray);
      border-radius: 0 0 16px 16px;
    }

    .edit-panel-footer .btn-group {
      display: flex;
      gap: 12px;
    }

    .btn-delete {
      background: white;
      border: 2px solid #dc3545;
      color: #dc3545;
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-delete:hover {
      background: #dc3545;
      color: white;
    }

    .btn-save {
      background: var(--navy);
      border: 2px solid var(--navy);
      color: white;
      padding: 10px 24px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }

    .btn-save:hover {
      background: #0d2840;
    }

    .btn-cancel {
      background: white;
      border: 2px solid var(--border-gray);
      color: var(--text-medium);
      padding: 10px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-cancel:hover {
      border-color: var(--text-medium);
    }
  </style>
</head>
<body>
  <div class="page-wrapper">

    <!-- HEADER -->
    <header class="main-header">
      <div class="header-container">
        <div class="header-left">
          <div class="logo-group">
            <img src="../assets/gannaca-logo.png" alt="gannaca" class="gannaca-logo">
            <div class="title-group">
              <h1 class="main-title">AI Case Sprint</h1>
              <p class="subtitle">Standardisiertes Framework für KI-Use-Case-Entwicklung</p>
            </div>
          </div>
        </div>
        <div class="header-right">
          <img src="../assets/trianel-logo.png" alt="Trianel" class="client-logo">
          <div class="header-info">
            <span class="version-badge">04.02.2026</span>
          </div>
        </div>
      </div>
    </header>

    <div class="terminology-mandatory">
      DATENSCHUTZ-KONFORM – KEINE PRODUKTIVDATEN<br>
      Dieses Mockup dient ausschließlich zur Visualisierung.<br>
      Alle gezeigten Beispiele sind fiktiv. Keine Erfassung,<br>
      Verarbeitung oder Speicherung von produktiven Trianel-Daten.
    </div>

    <!-- NAVIGATION -->
    <nav class="nav-tabs">
      <div class="nav-tabs-inner">
        <a href="screen-0-workshop-process.html" class="nav-tab"><span class="nav-tab-number">0</span> Workshop-Prozess</a>
        <a href="screen-1-overview.html" class="nav-tab"><span class="nav-tab-number">1</span> Übersicht</a>
        <a href="screen-2-kpi.html" class="nav-tab nav-tab-optional"><span class="nav-tab-number">2</span> KPI-Rahmen</a>
        <a href="screen-3-governance.html" class="nav-tab"><span class="nav-tab-number">3</span> Governance</a>
        <a href="screen-4-case-beispiel.html" class="nav-tab"><span class="nav-tab-number">4</span> Case-Beispiel</a>
        <a href="screen-5-tool-mockup.html" class="nav-tab"><span class="nav-tab-number">5</span> Mockup-Beispiel</a>
        <a href="screen-6-form.html" class="nav-tab"><span class="nav-tab-number">6</span> Case-Erfassung <i data-lucide="star" class="icon-sm"></i></a>
        <a href="screen-7-results.html" class="nav-tab active"><span class="nav-tab-number">7</span> Ergebnis</a>
      </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main-content">
      <div class="results-layout">

        <!-- HEADER -->
        <div class="results-header">
          <div>
            <h1>
              <i data-lucide="bar-chart-3" style="width:26px;height:26px;"></i>
              Workshop-Ergebnis: Longlist
              <span class="case-count-badge" id="caseCountBadge">0 Cases</span>
            </h1>
            <p>Dokumentierte Problemfälle – bereit für Bewertung & Priorisierung</p>
          </div>
        </div>

        <!-- CONTENT CONTAINER -->
        <div id="contentContainer">
          <!-- Wird per JS gefüllt -->
        </div>

        <!-- FOOTER -->
        <div class="results-footer">
          <a href="screen-6-form.html" class="btn btn-secondary">+ Neuen Case erfassen</a>
          <a href="screen-0-workshop-process.html" class="btn btn-primary">← Zurück zur Übersicht</a>
        </div>

      </div>
    </main>

    <!-- INLINE CASE EDIT PANEL -->
    <div class="edit-overlay" id="editOverlay">
      <div class="edit-panel">
        <div class="edit-panel-header">
          <h2><i data-lucide="edit-3" style="width:22px;height:22px;"></i> <span id="editPanelTitle">Case bearbeiten</span></h2>
          <button class="edit-panel-close" onclick="closeEditPanel()">
            <i data-lucide="x" style="width:20px;height:20px;"></i>
          </button>
        </div>

        <div class="edit-panel-body">
          <!-- FRAGE 1: Beschreibung der Ausgangslage -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">1</span> Beschreibung der Ausgangslage</div>
            <div class="edit-grid single">
              <div class="edit-field">
                <label class="edit-label">Titel / Kurzbeschreibung (max 120 Zeichen)</label>
                <input type="text" class="edit-input" id="edit-problemTitel" maxlength="120" placeholder="Aussagekräftiger Titel für den Case">
              </div>
            </div>
          </div>

          <!-- FRAGE 2: Betroffene Abteilung(en) -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">2</span> Betroffene Abteilung(en)</div>
            <div class="edit-grid single">
              <div class="edit-field">
                <label class="edit-label">Abteilungen (Mehrfachauswahl möglich)</label>
                <div class="edit-checkbox-group" id="edit-abteilungen">
                  <label class="edit-checkbox-item"><input type="checkbox" value="Legal & Insurance"><span>Legal & Insurance</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Compliance"><span>Compliance</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Revision"><span>Revision</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="IT & Consulting"><span>IT & Consulting</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Human Resources"><span>Human Resources</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Finance"><span>Finance</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Procurement"><span>Procurement</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Risk Management"><span>Risk Management</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Portfolio Management"><span>Portfolio Management</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Sales & Vertrieb"><span>Sales & Vertrieb</span></label>
                  <label class="edit-checkbox-item"><input type="checkbox" value="Market Analysis"><span>Market Analysis</span></label>
                </div>
              </div>
              <div class="edit-field">
                <label class="edit-label">Weitere Abteilung (Freitext)</label>
                <input type="text" class="edit-input" id="edit-weitereAbteilung" placeholder="Falls nicht in Liste enthalten...">
              </div>
            </div>
          </div>

          <!-- FRAGE 3: Was ist die Lage? -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">3</span> Was ist die Lage?</div>
            <div class="edit-grid single">
              <div class="edit-field">
                <label class="edit-label">Beschreiben Sie die aktuelle Situation</label>
                <textarea class="edit-textarea" id="edit-lage" placeholder="Wie ist die aktuelle Lage? Was passiert heute?"></textarea>
              </div>
            </div>
          </div>

          <!-- FRAGE 4: Prozessablauf -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">4</span> Prozessablauf</div>
            <div class="edit-grid single">
              <div class="edit-field">
                <label class="edit-label">Beschreiben Sie den aktuellen Prozessablauf</label>
                <textarea class="edit-textarea" id="edit-prozessablauf" placeholder="Wie läuft der Prozess heute ab? Welche Schritte gibt es?"></textarea>
              </div>
            </div>
          </div>

          <!-- FRAGE 5: Häufigkeit -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">5</span> Häufigkeit</div>
            <div class="edit-grid">
              <div class="edit-field full-width">
                <label class="edit-label">Wie oft tritt das Problem auf?</label>
                <div class="edit-radio-group" id="edit-haeufigkeit">
                  <label class="edit-radio-item"><input type="radio" name="edit-haeufigkeit" value="Täglich"><span>Täglich</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-haeufigkeit" value="Wöchentlich"><span>Wöchentlich</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-haeufigkeit" value="Monatlich"><span>Monatlich</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-haeufigkeit" value="Quartalsweise"><span>Quartalsweise</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-haeufigkeit" value="Jährlich"><span>Jährlich</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-haeufigkeit" value="Unregelmäßig"><span>Unregelmäßig</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-haeufigkeit" value="Unbestimmt"><span>Unbestimmt</span></label>
                </div>
              </div>
              <div class="edit-field">
                <label class="edit-label">Anzahl Vorgänge (optional)</label>
                <input type="number" class="edit-input" id="edit-anzahlVorgaenge" placeholder="z.B. 50">
              </div>
            </div>
          </div>

          <!-- FRAGE 6: Betroffene Personen & Zeitaufwand -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">6</span> Betroffene Personen & Zeitaufwand</div>
            <div class="edit-grid">
              <div class="edit-field">
                <label class="edit-label">Anzahl betroffener Personen</label>
                <input type="number" class="edit-input" id="edit-betroffenePersonen" placeholder="z.B. 3">
              </div>
              <div class="edit-field">
                <label class="edit-label">Qualifizierungsgrad</label>
                <select class="edit-select" id="edit-qualifizierungsgrad">
                  <option value="">Bitte wählen...</option>
                  <option value="niedrig">Niedrig qualifiziert</option>
                  <option value="mittel">Mittel qualifiziert</option>
                  <option value="hoch">Hoch qualifiziert</option>
                  <option value="experte">Experten</option>
                </select>
              </div>
              <div class="edit-field">
                <label class="edit-label">Zeitaufwand pro Vorgang</label>
                <div style="display:flex;gap:8px;">
                  <input type="number" class="edit-input" id="edit-zeitaufwandWert" placeholder="z.B. 20" style="flex:1;">
                  <select class="edit-select" id="edit-zeitaufwandEinheit" style="width:120px;">
                    <option value="minutes">Minuten</option>
                    <option value="hours">Stunden</option>
                  </select>
                </div>
              </div>
              <div class="edit-field">
                <label class="edit-label">Gesamtaufwand pro Jahr (optional)</label>
                <input type="text" class="edit-input" id="edit-gesamtaufwand" placeholder="z.B. 500 Stunden/Jahr">
              </div>
            </div>
          </div>

          <!-- FRAGE 7: Strategische Relevanz -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">7</span> Strategische Relevanz</div>
            <div class="edit-grid single">
              <div class="edit-field">
                <label class="edit-label">Erste Einschätzung der Relevanz</label>
                <div class="edit-radio-group" id="edit-strategischeRelevanz">
                  <label class="edit-radio-item"><input type="radio" name="edit-relevanz" value="Hoch"><span>Hoch</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-relevanz" value="Mittel"><span>Mittel</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-relevanz" value="Niedrig"><span>Niedrig</span></label>
                </div>
              </div>
            </div>
          </div>

          <!-- FRAGE 8: Risiko bei Nicht-Handlung -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">8</span> Risiko bei Nicht-Handlung</div>
            <div class="edit-grid">
              <div class="edit-field">
                <label class="edit-label">Risiko-Bewertung (1 = niedrig, 5 = kritisch)</label>
                <div class="edit-rating-group" id="edit-risiko">
                  <label class="edit-rating-item"><input type="radio" name="edit-risiko" value="1"><span>1</span></label>
                  <label class="edit-rating-item"><input type="radio" name="edit-risiko" value="2"><span>2</span></label>
                  <label class="edit-rating-item"><input type="radio" name="edit-risiko" value="3"><span>3</span></label>
                  <label class="edit-rating-item"><input type="radio" name="edit-risiko" value="4"><span>4</span></label>
                  <label class="edit-rating-item"><input type="radio" name="edit-risiko" value="5"><span>5</span></label>
                </div>
              </div>
              <div class="edit-field full-width">
                <label class="edit-label">Begründung (optional)</label>
                <textarea class="edit-textarea" id="edit-risikoBegruendung" placeholder="Warum diese Risikoeinstufung? Welche Konsequenzen drohen?"></textarea>
              </div>
            </div>
          </div>

          <!-- FRAGE 9: Vorhandene Lösungsansätze -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">9</span> Vorhandene Lösungsansätze</div>
            <div class="edit-grid">
              <div class="edit-field">
                <label class="edit-label">Gibt es bereits (Teil-)Lösungen?</label>
                <div class="edit-radio-group" id="edit-vorhandeneLoesung">
                  <label class="edit-radio-item"><input type="radio" name="edit-loesung" value="yes"><span>Ja</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-loesung" value="no"><span>Nein</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-loesung" value="unclear"><span>Unklar</span></label>
                </div>
              </div>
              <div class="edit-field full-width">
                <label class="edit-label">Falls ja, bitte beschreiben (optional)</label>
                <textarea class="edit-textarea" id="edit-vorhandeneLösungBeschreibung" placeholder="Welche Lösungen existieren bereits? Was funktioniert, was nicht?"></textarea>
              </div>
            </div>
          </div>

          <!-- FRAGE 10: Daten-Verfügbarkeit -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">10</span> Daten-Verfügbarkeit</div>
            <div class="edit-grid">
              <div class="edit-field">
                <label class="edit-label">Sind relevante Daten verfügbar?</label>
                <div class="edit-radio-group" id="edit-datenVerfuegbarkeit">
                  <label class="edit-radio-item"><input type="radio" name="edit-daten" value="full_digital"><span>Ja, vollständig digital</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-daten" value="partial"><span>Teilweise digital</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-daten" value="paper"><span>Überwiegend Papier</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-daten" value="unclear"><span>Unklar</span></label>
                </div>
              </div>
              <div class="edit-field full-width">
                <label class="edit-label">Details zur Datenlage (optional)</label>
                <textarea class="edit-textarea" id="edit-datenDetails" placeholder="Welche Daten sind vorhanden? In welchem Format? Wo gespeichert?"></textarea>
              </div>
            </div>
          </div>

          <!-- FRAGE 11: Unterstützung -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">11</span> Welche Art von Unterstützung wäre hilfreich?</div>
            <div class="edit-grid single">
              <div class="edit-field">
                <label class="edit-label">Ihre Vorstellung von einer Lösung</label>
                <textarea class="edit-textarea" id="edit-vorstellung" placeholder="z.B. Automatische Vollständigkeitsprüfung, Abgleich mit Richtlinien, Textanalyse, Chatbot für Anfragen..."></textarea>
              </div>
            </div>
          </div>

          <!-- SECTION G: Governance -->
          <div class="edit-section">
            <div class="edit-section-title"><span class="section-num">G</span> Governance & Legal Trigger</div>
            <div class="edit-grid">
              <div class="edit-field">
                <label class="edit-label">Entscheidungswirkung?</label>
                <div class="edit-radio-group">
                  <label class="edit-radio-item"><input type="radio" name="edit-entscheidung" value="ja"><span>Ja</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-entscheidung" value="nein"><span>Nein</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-entscheidung" value="unklar"><span>Unklar</span></label>
                </div>
              </div>
              <div class="edit-field">
                <label class="edit-label">KRITIS-Relevanz?</label>
                <div class="edit-radio-group">
                  <label class="edit-radio-item"><input type="radio" name="edit-kritis" value="ja"><span>Ja</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-kritis" value="nein"><span>Nein</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-kritis" value="unklar"><span>Unklar</span></label>
                </div>
              </div>
              <div class="edit-field">
                <label class="edit-label">Personenbezogene Daten?</label>
                <div class="edit-radio-group">
                  <label class="edit-radio-item"><input type="radio" name="edit-personenbezogen" value="ja"><span>Ja</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-personenbezogen" value="nein"><span>Nein</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-personenbezogen" value="unklar"><span>Unklar</span></label>
                </div>
              </div>
              <div class="edit-field">
                <label class="edit-label">Besondere Kategorien (Art. 9 DSGVO)?</label>
                <div class="edit-radio-group">
                  <label class="edit-radio-item"><input type="radio" name="edit-besondereKategorien" value="ja"><span>Ja</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-besondereKategorien" value="nein"><span>Nein</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-besondereKategorien" value="unklar"><span>Unklar</span></label>
                </div>
              </div>
              <div class="edit-field full-width">
                <label class="edit-label">Automationsgrad</label>
                <div class="edit-radio-group">
                  <label class="edit-radio-item"><input type="radio" name="edit-automation" value="informierend"><span>Informierend</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-automation" value="entscheidungsunterstuetzend"><span>Entscheidungsunterstützend</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-automation" value="teilautomatisiert"><span>Teilautomatisiert</span></label>
                  <label class="edit-radio-item"><input type="radio" name="edit-automation" value="vollautomatisiert"><span>Vollautomatisiert</span></label>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="edit-panel-footer">
          <button class="btn-delete" onclick="deleteCaseFromPanel()">
            <i data-lucide="trash-2" style="width:16px;height:16px;"></i> Löschen
          </button>
          <div class="btn-group">
            <button class="btn-cancel" onclick="closeEditPanel()">Abbrechen</button>
            <button class="btn-save" onclick="saveEditedCase()">
              <i data-lucide="check" style="width:18px;height:18px;"></i> Speichern
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      renderResults();

      // Tab highlighting
      const currentPage = window.location.pathname.split('/').pop();
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.getAttribute('href') === currentPage) {
          tab.classList.add('active');
        }
      });

      // Klick außerhalb des Edit-Panels zum Schließen
      const editOverlay = document.getElementById('editOverlay');
      if (editOverlay) {
        editOverlay.addEventListener('click', (e) => {
          if (e.target.id === 'editOverlay') {
            closeEditPanel();
          }
        });
      }
    });

    function renderResults() {
      const cases = getAllCases();
      const container = document.getElementById('contentContainer');
      const badge = document.getElementById('caseCountBadge');

      badge.textContent = cases.length + ' Cases';

      if (cases.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <i data-lucide="clipboard-list" style="width:64px;height:64px;color:var(--text-light);"></i>
            <h3>Noch keine Cases erfasst</h3>
            <p>Tab „Case-Erfassung" → ersten Case dokumentieren.</p>
            <div style="display: flex; gap: 12px;">
              <a href="screen-6-form.html" class="btn btn-primary"><i data-lucide="plus" class="icon-sm"></i> Ersten Case erfassen</a>
              <button class="btn btn-secondary" onclick="loadDemo()"><i data-lucide="database" class="icon-sm"></i> Demo-Daten laden</button>
            </div>
          </div>
        `;
        lucide.createIcons();
        return;
      }

      // Calculate stats
      const allDepartments = new Set();
      let highPriorityCount = 0;
      let totalRisk = 0;
      let riskCount = 0;

      cases.forEach(c => {
        if (c.abteilungen) c.abteilungen.forEach(a => allDepartments.add(a));
        if (c.strategischeRelevanz === 'Hoch') highPriorityCount++;
        if (c.risiko) { totalRisk += parseInt(c.risiko); riskCount++; }
      });

      const avgRisk = riskCount > 0 ? (totalRisk / riskCount).toFixed(1) : '-';
      const displayCases = cases; // Alle Cases anzeigen
      const moreCases = 0;

      let html = `
        <!-- STATS -->
        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-number">${cases.length}</span>
            <span class="stat-label">Erfasste Cases</span>
          </div>
          <div class="stat-card">
            <span class="stat-number">${allDepartments.size}</span>
            <span class="stat-label">Abteilungen beteiligt</span>
          </div>
          <div class="stat-card">
            <span class="stat-number">${highPriorityCount}</span>
            <span class="stat-label">Hohe Relevanz</span>
          </div>
          <div class="stat-card">
            <span class="stat-number">${avgRisk}</span>
            <span class="stat-label">Ø Risiko-Score</span>
          </div>
        </div>

        <!-- CASE CARDS -->
        <div class="cases-preview">
      `;

      displayCases.forEach(c => {
        const relevanzClass = c.strategischeRelevanz ? `relevanz-${c.strategischeRelevanz.toLowerCase()}` : '';
        const abteilungen = c.abteilungen ? c.abteilungen.slice(0, 2).join(', ') : 'k.A.';
        const problem = c.problem ? (c.problem.length > 100 ? c.problem.substring(0, 100) + '...' : c.problem) : 'Keine Beschreibung';

        html += `
          <div class="case-card" onclick="editCase(${c.caseNumber})" style="cursor: pointer;" title="Klicken zum Bearbeiten">
            <div class="case-card-header">
              <span class="case-number">CASE #${c.caseNumber.toString().padStart(2, '0')}</span>
              ${c.strategischeRelevanz ? `<span class="case-relevanz ${relevanzClass}">${c.strategischeRelevanz}</span>` : ''}
            </div>
            <h4 class="case-title">${c.problemTitel || 'Kein Titel'}</h4>
            <span class="case-abteilung">
              <i data-lucide="users" style="width:12px;height:12px;"></i>
              ${abteilungen}
            </span>
            <p class="case-problem">${problem}</p>
            <div class="case-footer">
              <span><i data-lucide="alert-triangle" style="width:12px;height:12px;"></i> Risiko: ${c.risiko || '-'}/5</span>
              <span><i data-lucide="calendar" style="width:12px;height:12px;"></i> ${c.haeufigkeit || '-'}</span>
            </div>
            <div class="case-edit-hint"><i data-lucide="edit-3" style="width:14px;height:14px;"></i> Bearbeiten</div>
          </div>
        `;
      });

      html += '</div>';

      // More cases indicator
      if (moreCases > 0) {
        html += `<div class="more-cases">+ <strong>${moreCases} weitere Cases</strong> in der vollständigen Longlist</div>`;
      }

      // Bottom section
      html += `
        <div class="bottom-section" style="margin-top: 20px;">
          <div class="status-box">
            <h3>✓ Status: Erfassung abgeschlossen</h3>
            <p>Alle Cases wurden strukturiert erfasst und sind bereit für die KI-gestützte Analyse.</p>
          </div>
          <div class="status-box">
            <h3>Nächste Schritte</h3>
            <ol class="next-steps-list">
              <li>Nutzen-Risiko-Bewertung</li>
              <li>Machbarkeits-Einschätzung</li>
              <li>Identifikation Top-3 Cases</li>
            </ol>
          </div>
        </div>

        <div class="export-bar" style="margin-top: 16px;">
          <button class="btn btn-primary" onclick="exportForEvaluator()">
            <i data-lucide="sparkles" class="icon-sm"></i> Export für AI Case Evaluator
          </button>
          <button class="btn btn-secondary btn-sm" onclick="exportAsJSON()">
            <i data-lucide="file-text" class="icon-sm"></i> JSON-Backup
          </button>
          <button class="btn btn-tertiary btn-sm" onclick="confirmClearAll()">
            <i data-lucide="trash-2" class="icon-sm"></i> Alle löschen
          </button>
        </div>
      `;

      container.innerHTML = html;
      lucide.createIcons();
    }

    function loadDemo() {
      if (confirm('Demo-Daten laden?')) {
        loadDemoData();
        renderResults();
      }
    }

    // ============================================
    // INLINE CASE EDIT FUNKTIONEN
    // ============================================
    let currentEditCaseNumber = null;

    // Case zum Bearbeiten öffnen (Inline Panel)
    function editCase(caseNumber) {
      currentEditCaseNumber = caseNumber;
      const cases = getAllCases();
      const caseData = cases.find(c => c.caseNumber === caseNumber);

      if (!caseData) {
        alert('Case nicht gefunden!');
        return;
      }

      // Panel-Titel setzen
      document.getElementById('editPanelTitle').textContent = `Case #${caseNumber.toString().padStart(2, '0')} bearbeiten`;

      // Frage 1: Beschreibung der Ausgangslage
      document.getElementById('edit-problemTitel').value = caseData.problemTitel || '';

      // Frage 2: Betroffene Abteilungen
      document.querySelectorAll('#edit-abteilungen input').forEach(cb => cb.checked = false);
      if (caseData.abteilungen && Array.isArray(caseData.abteilungen)) {
        caseData.abteilungen.forEach(abt => {
          const cb = document.querySelector(`#edit-abteilungen input[value="${abt}"]`);
          if (cb) cb.checked = true;
        });
      }
      document.getElementById('edit-weitereAbteilung').value = caseData.weitereAbteilung || '';

      // Frage 3: Was ist die Lage?
      document.getElementById('edit-lage').value = caseData.lage || caseData.ausgangslage || '';

      // Frage 4: Prozessablauf
      document.getElementById('edit-prozessablauf').value = caseData.prozessablauf || caseData.problem || '';

      // Frage 5: Häufigkeit
      setEditRadio('edit-haeufigkeit', caseData.haeufigkeit);
      document.getElementById('edit-anzahlVorgaenge').value = caseData.anzahlVorgaenge || '';

      // Frage 6: Betroffene Personen & Zeitaufwand
      document.getElementById('edit-betroffenePersonen').value = caseData.betroffenePersonen || '';
      document.getElementById('edit-qualifizierungsgrad').value = caseData.qualifizierungsgrad || '';
      document.getElementById('edit-zeitaufwandWert').value = caseData.zeitaufwandWert || '';
      document.getElementById('edit-zeitaufwandEinheit').value = caseData.zeitaufwandEinheit || 'minutes';
      document.getElementById('edit-gesamtaufwand').value = caseData.gesamtaufwand || '';

      // Frage 7: Strategische Relevanz
      setEditRadio('edit-relevanz', caseData.strategischeRelevanz);

      // Frage 8: Risiko bei Nicht-Handlung
      setEditRadio('edit-risiko', caseData.risiko);
      document.getElementById('edit-risikoBegruendung').value = caseData.risikoBegruendung || '';

      // Frage 9: Vorhandene Lösungsansätze
      setEditRadio('edit-loesung', caseData.vorhandeneLoesung);
      document.getElementById('edit-vorhandeneLösungBeschreibung').value = caseData.vorhandeneLösungBeschreibung || '';

      // Frage 10: Daten-Verfügbarkeit
      setEditRadio('edit-daten', caseData.datenVerfuegbarkeit);
      document.getElementById('edit-datenDetails').value = caseData.datenDetails || '';

      // Frage 11: Unterstützung
      document.getElementById('edit-vorstellung').value = caseData.vorstellung || caseData.kiPotenzial || '';

      // Governance-Felder
      setEditRadio('edit-entscheidung', caseData.entscheidungswirkung);
      setEditRadio('edit-kritis', caseData.kritisRelevanz);
      setEditRadio('edit-personenbezogen', caseData.personenbezogen);
      setEditRadio('edit-besondereKategorien', caseData.besondereKategorien);
      setEditRadio('edit-automation', caseData.automationsgrad);

      // Panel öffnen
      document.getElementById('editOverlay').classList.add('active');
      document.body.style.overflow = 'hidden';
      lucide.createIcons();
    }

    function setEditRadio(name, value) {
      if (!value) return;
      const radio = document.querySelector(`input[name="${name}"][value="${value}"]`);
      if (radio) radio.checked = true;
    }

    function getEditRadio(name) {
      const checked = document.querySelector(`input[name="${name}"]:checked`);
      return checked ? checked.value : null;
    }

    function closeEditPanel() {
      document.getElementById('editOverlay').classList.remove('active');
      document.body.style.overflow = '';
      currentEditCaseNumber = null;
    }

    function saveEditedCase() {
      if (!currentEditCaseNumber) return;

      // Daten aus dem Formular sammeln (alle 11 Fragen + Governance)
      const updatedData = {
        // Frage 1: Beschreibung der Ausgangslage
        problemTitel: document.getElementById('edit-problemTitel').value,

        // Frage 2: Betroffene Abteilungen
        abteilungen: Array.from(document.querySelectorAll('#edit-abteilungen input:checked')).map(cb => cb.value),
        weitereAbteilung: document.getElementById('edit-weitereAbteilung').value,

        // Frage 3: Was ist die Lage?
        lage: document.getElementById('edit-lage').value,
        ausgangslage: document.getElementById('edit-lage').value, // Kompatibilität

        // Frage 4: Prozessablauf
        prozessablauf: document.getElementById('edit-prozessablauf').value,
        problem: document.getElementById('edit-prozessablauf').value, // Kompatibilität

        // Frage 5: Häufigkeit
        haeufigkeit: getEditRadio('edit-haeufigkeit'),
        anzahlVorgaenge: document.getElementById('edit-anzahlVorgaenge').value,

        // Frage 6: Betroffene Personen & Zeitaufwand
        betroffenePersonen: document.getElementById('edit-betroffenePersonen').value,
        qualifizierungsgrad: document.getElementById('edit-qualifizierungsgrad').value,
        zeitaufwandWert: document.getElementById('edit-zeitaufwandWert').value,
        zeitaufwandEinheit: document.getElementById('edit-zeitaufwandEinheit').value,
        gesamtaufwand: document.getElementById('edit-gesamtaufwand').value,

        // Frage 7: Strategische Relevanz
        strategischeRelevanz: getEditRadio('edit-relevanz'),

        // Frage 8: Risiko bei Nicht-Handlung
        risiko: getEditRadio('edit-risiko'),
        risikoBegruendung: document.getElementById('edit-risikoBegruendung').value,

        // Frage 9: Vorhandene Lösungsansätze
        vorhandeneLoesung: getEditRadio('edit-loesung'),
        vorhandeneLösungBeschreibung: document.getElementById('edit-vorhandeneLösungBeschreibung').value,

        // Frage 10: Daten-Verfügbarkeit
        datenVerfuegbarkeit: getEditRadio('edit-daten'),
        datenDetails: document.getElementById('edit-datenDetails').value,

        // Frage 11: Unterstützung
        vorstellung: document.getElementById('edit-vorstellung').value,
        kiPotenzial: document.getElementById('edit-vorstellung').value, // Kompatibilität

        // Governance
        entscheidungswirkung: getEditRadio('edit-entscheidung'),
        kritisRelevanz: getEditRadio('edit-kritis'),
        personenbezogen: getEditRadio('edit-personenbezogen'),
        besondereKategorien: getEditRadio('edit-besondereKategorien'),
        automationsgrad: getEditRadio('edit-automation')
      };

      // Case aktualisieren
      updateCase(currentEditCaseNumber, updatedData);

      // Panel schließen
      closeEditPanel();

      // Liste aktualisieren
      renderResults();

      // Erfolgs-Feedback
      if (typeof toastSuccess === 'function') {
        toastSuccess('Gespeichert', `Case #${currentEditCaseNumber.toString().padStart(2, '0')} wurde aktualisiert.`);
      } else {
        alert(`Case #${currentEditCaseNumber.toString().padStart(2, '0')} wurde aktualisiert.`);
      }
    }

    function deleteCaseFromPanel() {
      if (!currentEditCaseNumber) return;

      if (confirm(`Case #${currentEditCaseNumber.toString().padStart(2, '0')} wirklich löschen?`)) {
        deleteCase(currentEditCaseNumber);
        closeEditPanel();
        renderResults();

        if (typeof toastSuccess === 'function') {
          toastSuccess('Gelöscht', 'Der Case wurde entfernt.');
        }
      }
    }

    // ESC zum Schließen
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && document.getElementById('editOverlay').classList.contains('active')) {
        closeEditPanel();
      }
    });


    function confirmClearAll() {
      if (confirm('⚠️ Wirklich ALLE Cases löschen?')) {
        clearAllCases();
        renderResults();
      }
    }

    function exportAsJSON() {
      const data = exportCasesAsJSON();
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `gannaca-cases-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
    }

    function exportForEvaluator() {
      const cases = getAllCases();
      if (cases.length === 0) {
        alert('Keine Cases zum Exportieren.');
        return;
      }

      const evaluatorData = {
        meta: {
          exportDate: new Date().toISOString(),
          source: 'gannaca AI Case Sprint Framework',
          totalCases: cases.length
        },
        cases: cases.map(c => ({
          caseId: c.caseNumber,
          problemTitel: c.problemTitel || '',
          abteilungen: c.abteilungen || [],
          ausgangslage: c.ausgangslage || '',
          problem: c.problem || '',
          haeufigkeit: c.haeufigkeit || '',
          risiko: c.risiko || '',
          datenVerfuegbarkeit: c.datenVerfuegbarkeit || ''
        }))
      };

      const blob = new Blob([JSON.stringify(evaluatorData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `evaluator-input-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      alert('Export erfolgreich! ' + cases.length + ' Case(s) exportiert.');
    }
  </script>

  <script>lucide.createIcons();</script>
</body>
</html>
